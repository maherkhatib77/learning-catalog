<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מערכת ניהול - קטלוג פתרונות למידה</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="admin-container">
        <!-- Header -->
        <header class="admin-header">
            <div class="admin-title">
                <div class="admin-logo">⚙️</div>
                <div class="title-text">
                    <h1>מערכת ניהול קטלוג פתרונות למידה</h1>
                    <p id="dashboard-subtitle">מערכת ניהול מתקדמת</p>
                </div>
            </div>
            <div class="user-info">
                <div class="user-profile">
                    <div class="user-avatar" id="user-avatar">P</div>
                    <div>
                        <div style="font-weight: 600; font-size: 14px;" id="user-name">Pisga</div>
                        <div style="font-size: 12px; color: #718096;" id="user-role">מנהל-על</div>
                    </div>
                </div>
                <button class="logout-btn" onclick="logout()">יציאה</button>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="admin-nav">
            <div class="nav-tabs" id="nav-tabs">
                <!-- Dynamic tabs will be loaded here -->
            </div>
        </nav>

        <!-- Content -->
        <main class="admin-content">
            <!-- Pedagogical Instructor Dashboard -->
            <div id="instructor-dashboard" class="tab-content">
                <h2 style="margin-bottom: 25px; color: #2d3748; text-align: center;">📚 ניהול פתרונות למידה</h2>
                
                <div class="action-cards">
                    <div class="action-card" onclick="showAddSolutionForm()">
                        <div class="card-icon">➕</div>
                        <div class="card-title">הוספת פתרון חדש</div>
                        <div class="card-description">יצירת פתרון למידה חדש עם כל הפרטים הנדרשים</div>
                        <div class="card-actions">
                            <button class="btn">התחל עכשיו</button>
                        </div>
                    </div>

                    <div class="action-card" onclick="showMySolutions()">
                        <div class="card-icon">📋</div>
                        <div class="card-title">הפתרונות שלי</div>
                        <div class="card-description">צפייה ועריכה של כל פתרונות הלמידה שיצרתי</div>
                        <div class="card-actions">
                            <button class="btn">צפה ברשימה</button>
                            <button class="btn btn-secondary">ערוך</button>
                        </div>
                    </div>

                    <div class="action-card" onclick="exportMySolutions()">
                        <div class="card-icon">📤</div>
                        <div class="card-title">ייצוא נתונים</div>
                        <div class="card-description">הדפסה ושמירת רשימת הפתרונות ל-PDF או Excel</div>
                        <div class="card-actions">
                            <button class="btn btn-success">PDF</button>
                            <button class="btn btn-success">Excel</button>
                            <button class="btn btn-secondary">הדפס</button>
                        </div>
                    </div>

                    <div class="action-card">
                        <div class="card-icon">📊</div>
                        <div class="card-title">סטטיסטיקות</div>
                        <div class="card-description">נתונים על הפתרונות שלי וביצועיהם</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px;">
                            <div style="text-align: center; background: #f7fafc; padding: 10px; border-radius: 8px;">
                                <strong style="color: #667eea; font-size: 1.2rem;">12</strong>
                                <div style="font-size: 11px; color: #718096;">פתרונות פעילים</div>
                            </div>
                            <div style="text-align: center; background: #f7fafc; padding: 10px; border-radius: 8px;">
                                <strong style="color: #38a169; font-size: 1.2rem;">284</strong>
                                <div style="font-size: 11px; color: #718096;">משתתפים</div>
                            </div>
                            <div style="text-align: center; background: #f7fafc; padding: 10px; border-radius: 8px;">
                                <strong style="color: #d69e2e; font-size: 1.2rem;">3</strong>
                                <div style="font-size: 11px; color: #718096;">בהכנה</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Solutions Table -->
                <div class="solutions-table">
                    <div class="table-header">
                        <div class="table-title">הפתרונות שלי</div>
                        <div class="table-controls">
                            <input type="text" class="search-box" placeholder="חיפוש פתרון...">
                            <button class="btn">סנן</button>
                        </div>
                    </div>
                    <div class="table-content">
                        <table>
                            <thead>
                                <tr>
                                    <th>מספר</th>
                                    <th>שם הפתרון</th>
                                    <th>מנחה</th>
                                    <th>שלב חינוך</th>
                                    <th>היקף שעות</th>
                                    <th>סטטוס</th>
                                    <th>פעולות</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>001</td>
                                    <td>חשיבה מתמטית יצירתית</td>
                                    <td>פרופ' משה לוי</td>
                                    <td>יסודי</td>
                                    <td>40 שעות</td>
                                    <td><span class="status-badge status-active">פעיל</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn btn-small">ערוך</button>
                                            <button class="btn btn-small btn-secondary">הסתר</button>
                                            <button class="btn btn-small btn-danger">מחק</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>007</td>
                                    <td>פיזיקה דרך ניסויים</td>
                                    <td>ד"ר אמיר כהן</td>
                                    <td>תיכון</td>
                                    <td>45 שעות</td>
                                    <td><span class="status-badge status-active">פעיל</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn btn-small">ערוך</button>
                                            <button class="btn btn-small btn-secondary">הסתר</button>
                                            <button class="btn btn-small btn-danger">מחק</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>012</td>
                                    <td>אומנות דיגיטלית</td>
                                    <td>יעל ברק</td>
                                    <td>על-יסודי</td>
                                    <td>30 שעות</td>
                                    <td><span class="status-badge status-draft">בהכנה</span></td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn btn-small">ערוך</button>
                                            <button class="btn btn-small btn-success">פרסם</button>
                                            <button class="btn btn-small btn-danger">מחק</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Super Admin Dashboard -->
            <div id="super-admin-dashboard" class="tab-content active">
                <h2 style="margin-bottom: 25px; color: #2d3748; text-align: center;">🔧 ניהול מערכת מתקדם</h2>
                
                <div class="modules-grid">
                    <!-- Users Management Module -->
                    <div class="module-card" onclick="openModule('users')">
                        <div class="module-header">
                            <div class="module-icon">👥</div>
                            <div class="module-info">
                                <h3>ניהול משתמשים והרשאות</h3>
                                <p>ניהול מדריכים, מנהלים והרשאות מערכת</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">24</span>
                                <div class="stat-label">מדריכים</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">3</span>
                                <div class="stat-label">מנהלים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn">הוסף משתמש</button>
                            <button class="btn btn-secondary">ערוך הרשאות</button>
                            <button class="btn btn-secondary">ייבא Excel</button>
                        </div>
                    </div>

                    <!-- Site Info Module -->
                    <div class="module-card" onclick="openModule('siteinfo')">
                        <div class="module-header">
                            <div class="module-icon">🌐</div>
                            <div class="module-info">
                                <h3>מידע כללי לאתר</h3>
                                <p>עדכון לוגו, פרטי קשר, שעות פעילות</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">✓</span>
                                <div class="stat-label">מעודכן</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">2025</span>
                                <div class="stat-label">שנת לימודים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn">עדכן פרטים</button>
                            <button class="btn btn-secondary">החלף לוגו</button>
                        </div>
                    </div>

                    <!-- Additional modules... -->
                    <div class="module-card" onclick="openModule('instructors')">
                        <div class="module-header">
                            <div class="module-icon">👨‍🏫</div>
                            <div class="module-info">
                                <h3>מדריכים פדגוגיים</h3>
                                <p>ניהול מדריכים, פרטים אישיים והרשאות</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">24</span>
                                <div class="stat-label">מדריכים</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">18</span>
                                <div class="stat-label">פעילים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn">הוסף מדריך</button>
                            <button class="btn btn-secondary">ערוך רשימה</button>
                            <button class="btn btn-secondary">ייבא Excel</button>
                        </div>
                    </div>

                    <!-- Site Info Module -->
                    <div class="module-card" onclick="openModule('siteinfo')">
                        <div class="module-header">
                            <div class="module-icon">🌐</div>
                            <div class="module-info">
                                <h3>מידע כללי לאתר</h3>
                                <p>עדכון לוגו, פרטי קשר, שעות פעילות</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">✓</span>
                                <div class="stat-label">מעודכן</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">2025</span>
                                <div class="stat-label">שנת לימודים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn" onclick="window.location.href='site-info.html'">עדכן פרטים</button>
                            <button class="btn btn-secondary" onclick="siteInfoFrontend.showEditModal()">החלף לוגו</button>
                        </div>
                    </div>

                    <!-- Pedagogical Instructors Module -->
                    <div class="module-card" onclick="openModule('instructors')">
                        <div class="module-header">
                            <div class="module-icon">👨‍🏫</div>
                            <div class="module-info">
                                <h3>מדריכים פדגוגיים</h3>
                                <p>ניהול מדריכים, פרטים אישיים והרשאות</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="instructors-count">-</span>
                                <div class="stat-label">מדריכים</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="active-instructors-count">-</span>
                                <div class="stat-label">פעילים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn" onclick="window.location.href='instructors.html'">ניהול מדריכים</button>
                            <button class="btn btn-secondary" onclick="instructorsFrontend.showAddModal()">הוסף מדריך</button>
                            <button class="btn btn-secondary" onclick="instructorsFrontend.showExportModal()">ייצא נתונים</button>
                        </div>
                    </div>

                    <!-- Additional modules... -->
                    <div class="module-card" onclick="openModule('lecturers')">
                        <div class="module-header">
                            <div class="module-icon">🎓</div>
                            <div class="module-info">
                                <h3>מנחים</h3>
                                <p>ניהול מנחים, פרטי התקשרות ושיוך לפתרונות</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">42</span>
                                <div class="stat-label">מנחים</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">35</span>
                                <div class="stat-label">פעילים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn">הוסף מנחה</button>
                            <button class="btn btn-secondary">עדכן פרטים</button>
                            <button class="btn btn-secondary">ייבא רשימה</button>
                        </div>
                    </div>

                    <!-- Learning Modes Module -->
                    <div class="module-card" onclick="openModule('learning-modes')">
                        <div class="module-header">
                            <div class="module-icon">📹</div>
                            <div class="module-info">
                                <h3>אופני הלמידה</h3>
                                <p>הגדרת סוגי מפגש (פנים-אל-פנים, סינכרוני, וכו')</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">4</span>
                                <div class="stat-label">אופנים</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">✓</span>
                                <div class="stat-label">מוגדר</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn">הוסף אופן</button>
                            <button class="btn btn-secondary">ערוך רשימה</button>
                        </div>
                    </div>

                    <!-- Continue with other modules... -->
                    <div class="module-card" onclick="openModule('all-solutions')">
                        <div class="module-header">
                            <div class="module-icon">📋</div>
                            <div class="module-info">
                                <h3>כל פתרונות הלמידה</h3>
                                <p>ניהול מרכזי של כלל פתרונות הלמידה במערכת</p>
                            </div>
                        </div>
                        <div class="module-stats">
                            <div class="stat-item">
                                <span class="stat-number">67</span>
                                <div class="stat-label">פתרונות</div>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">52</span>
                                <div class="stat-label">פעילים</div>
                            </div>
                        </div>
                        <div class="module-actions">
                            <button class="btn">צפה בכל</button>
                            <button class="btn btn-secondary">ייצא נתונים</button>
                            <button class="btn btn-success">אישור מסיבי</button>
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- Add Solution Form -->
            <div id="add-solution-form" class="tab-content">
                <div class="form-section">
                    <div class="form-title">➕ הוספת פתרון למידה חדש</div>
                    <form onsubmit="saveSolution(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">פתרון למידה מס'</label>
                                <input type="text" class="form-input" placeholder="מספר מזהה אוטומטי" readonly value="067">
                            </div>
                            <div class="form-group">
                                <label class="form-label">שם פתרון הלמידה *</label>
                                <input type="text" class="form-input" placeholder="הכנס שם הפתרון" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">מדריך פדגוגי</label>
                                <input type="text" class="form-input" value="Pisga (מחובר)" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">מנחה *</label>
                                <select class="form-select" required>
                                    <option value="">בחר מנחה</option>
                                    <option value="prof-levy">פרופ' משה לוי</option>
                                    <option value="dr-rosen">ד"ר יעל רוזן</option>
                                    <option value="prof-barak">פרופ' שרה ברק</option>
                                    <option value="lisa-johnson">ליסה ג'ונסון</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">שלב חינוך *</label>
                                <select class="form-select" required>
                                    <option value="">בחר שלב חינוך</option>
                                    <option value="pre-elementary">קדם-יסודי</option>
                                    <option value="elementary">יסודי</option>
                                    <option value="middle-school">על-יסודי</option>
                                    <option value="high-school">תיכון</option>
                                    <option value="special-education">חינוך מיוחד</option>
                                    <option value="general">כללי</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">תחום דעת *</label>
                                <select class="form-select" required>
                                    <option value="">בחר תחום דעת</option>
                                    <option value="hebrew">שפה עברית</option>
                                    <option value="arabic">שפה ערבית</option>
                                    <option value="math">מתמטיקה</option>
                                    <option value="science">מדעים</option>
                                    <option value="english">אנגלית</option>
                                    <option value="history">היסטוריה</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">היקף שעות אקדמאיות *</label>
                                <select class="form-select" required>
                                    <option value="">בחר היקף שעות</option>
                                    <option value="20">20 שעות</option>
                                    <option value="25">25 שעות</option>
                                    <option value="30">30 שעות</option>
                                    <option value="40">40 שעות</option>
                                    <option value="50">50 שעות</option>
                                    <option value="60">60 שעות</option>
                                    <option value="80">80 שעות</option>
                                    <option value="120">120 שעות</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">אופן למידה *</label>
                                <select class="form-select" required>
                                    <option value="">בחר אופן למידה</option>
                                    <option value="face-to-face">פנים אל פנים</option>
                                    <option value="synchronous">סינכרוני</option>
                                    <option value="asynchronous">א-סינכרוני</option>
                                    <option value="hybrid">היברידי</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">יום מפגש קבוע *</label>
                                <select class="form-select" required>
                                    <option value="">בחר יום</option>
                                    <option value="sunday">ראשון</option>
                                    <option value="monday">שני</option>
                                    <option value="tuesday">שלישי</option>
                                    <option value="wednesday">רביעי</option>
                                    <option value="thursday">חמישי</option>
                                    <option value="friday">שישי</option>
                                    <option value="saturday">שבת</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">שעת התחלה</label>
                                <input type="time" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">שעת סיום</label>
                                <input type="time" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">תאריך התחלת המפגשים</label>
                                <input type="date" class="form-input">
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <label class="form-label">מטרות הלמידה *</label>
                            <textarea class="form-textarea" placeholder="תאר את מטרות הלמידה של הפתרון..." required></textarea>
                        </div>

                        <div class="form-grid" style="margin-top: 20px;">
                            <div class="form-group">
                                <label class="form-label">נוצר קשר עם המנחה</label>
                                <select class="form-select">
                                    <option value="no">לא</option>
                                    <option value="in-progress">בתהליך</option>
                                    <option value="yes">כן</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">סטטוס סילבוס</label>
                                <select class="form-select">
                                    <option value="waiting">ממתין להכנה</option>
                                    <option value="in-preparation">בהכנה</option>
                                    <option value="ready">סילבוס מוכן</option>
                                    <option value="approved">סילבוס מאושר</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-success" style="padding: 12px 30px; font-size: 16px;">💾 שמור פתרון</button>
                            <button type="button" class="btn btn-secondary" onclick="showInstructorDashboard()" style="padding: 12px 30px; font-size: 16px;">❌ ביטול</button>
                            <button type="button" class="btn" onclick="saveDraft()" style="padding: 12px 30px; font-size: 16px;">📝 שמור כטיוטה</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- Backend Scripts -->
    <script src="js/site-info-backend.js"></script>
    <script src="js/instructors-backend.js"></script>
    
    <!-- Frontend Scripts -->
    <script src="js/site-info-frontend.js"></script>
    <script src="js/instructors-frontend.js"></script>
    
    <!-- Main Script -->
    <script src="js/script.js"></script>
    
    <script>
        // אתחול מערכת האדמין המשופרת
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 מערכת ניהול מתחילה...');
            
            // המתנה לטעינת המודולים
            let attempts = 0;
            const maxAttempts = 50;
            
            while ((!window.siteInfoBackend || !window.instructorsBackend) && attempts < maxAttempts) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            
            if (window.siteInfoBackend) {
                console.log('✅ מודול מידע כללי נטען');
                
                // החלת מידע כללי על דף האדמין
                try {
                    await window.siteInfoFrontend.loadSiteInfo();
                    window.siteInfoFrontend.applyGlobalSiteInfo();
                    console.log('✅ מידע כללי הוחל על דף האדמין');
                } catch (error) {
                    console.error('❌ שגיאה בהחלת מידע כללי:', error);
                }
            }
            
            if (window.instructorsBackend) {
                console.log('✅ מודול מדריכים נטען');
                
                // עדכון סטטיסטיקות מדריכים
                try {
                    const stats = await window.instructorsBackend.getInstructorStats();
                    if (stats.success) {
                        updateInstructorStats(stats.data);
                    }
                } catch (error) {
                    console.error('❌ שגיאה בטעינת סטטיסטיקות מדריכים:', error);
                }
            }
            
            // אתחול מערכת האדמין המקורית
            if (typeof initSystem === 'function') {
                initSystem();
            }
            
            console.log('🎯 מערכת ניהול מוכנה לשימוש');
        });
        
        // עדכון סטטיסטיקות מדריכים
        function updateInstructorStats(stats) {
            const totalElement = document.getElementById('instructors-count');
            const activeElement = document.getElementById('active-instructors-count');
            
            if (totalElement) {
                totalElement.textContent = stats.total;
            }
            if (activeElement) {
                activeElement.textContent = stats.active;
            }
        }
        
        // עדכון פונקציית openModule לתמיכה במודולים החדשים
        function openModule(moduleId) {
            switch(moduleId) {
                case 'siteinfo':
                    window.location.href = 'site-info.html';
                    break;
                case 'instructors':
                    window.location.href = 'instructors.html';
                    break;
                default:
                    alert(`פתיחת מודול: ${moduleId}\nהמודול יפותח בגרסאות עתידיות של המערכת`);
            }
        }
        
        // הוספת פונקציות עזר נוספות
        window.adminUtils = {
            // רענון כל הנתונים
            refreshAllData: async function() {
                try {
                    if (window.siteInfoFrontend) {
                        await window.siteInfoFrontend.refreshSiteInfo();
                    }
                    if (window.instructorsFrontend) {
                        await window.instructorsFrontend.loadInstructors();
                    }
                    showNotification('כל הנתונים רוענו בהצלחה', 'success');
                } catch (error) {
                    showNotification('שגיאה ברענון הנתונים: ' + error.message, 'error');
                }
            },
            
            // בדיקת מצב המערכת
            checkSystemHealth: async function() {
                const health = {
                    siteInfo: !!window.siteInfoBackend,
                    instructors: !!window.instructorsBackend,
                    maintenance: false
                };
                
                if (window.siteInfoBackend) {
                    try {
                        const maintenanceResult = await window.siteInfoBackend.isMaintenanceMode();
                        health.maintenance = maintenanceResult.success ? maintenanceResult.data : false;
                    } catch (error) {
                        console.error('שגיאה בבדיקת מצב תחזוקה:', error);
                    }
                }
                
                return health;
            },
            
            // ייצוא כל הנתונים
            exportAllData: async function() {
                try {
                    const exports = {};
                    
                    if (window.siteInfoBackend) {
                        const siteInfoResult = await window.siteInfoBackend.exportSettings();
                        if (siteInfoResult.success) {
                            exports.siteInfo = JSON.parse(siteInfoResult.data);
                        }
                    }
                    
                    if (window.instructorsBackend) {
                        const instructorsResult = await window.instructorsBackend.exportInstructors('json');
                        if (instructorsResult.success) {
                            exports.instructors = JSON.parse(instructorsResult.data);
                        }
                    }
                    
                    const fullExport = {
                        ...exports,
                        exportDate: new Date().toISOString(),
                        version: '1.0'
                    };
                    
                    const blob = new Blob([JSON.stringify(fullExport, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `full-system-backup-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    showNotification('גיבוי מלא של המערכת יוצא בהצלחה', 'success');
                } catch (error) {
                    showNotification('שגיאה בייצוא נתונים: ' + error.message, 'error');
                }
            }
        };
        
        // הוספת כפתורי עזר לממשק
        function addUtilityButtons() {
            const utilityBar = document.createElement('div');
            utilityBar.className = 'utility-bar';
            utilityBar.innerHTML = `
                <div class="utility-buttons">
                    <button class="btn btn-small" onclick="adminUtils.refreshAllData()">🔄 רענן הכל</button>
                    <button class="btn btn-small" onclick="adminUtils.exportAllData()">📦 גיבוי מלא</button>
                    <button class="btn btn-small" onclick="adminUtils.checkSystemHealth().then(h => console.log('מצב המערכת:', h))">🔍 בדיקת מערכת</button>
                </div>
            `;
            utilityBar.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 20px;
                z-index: 1000;
                background: rgba(255,255,255,0.95);
                padding: 10px;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            `;
            document.body.appendChild(utilityBar);
        }
        
        // הוספת כפתורי עזר לאחר טעינת העמוד
        setTimeout(addUtilityButtons, 2000);
        
        console.log('🎯 דף אדמין משופר מוכן לשימוש');
    </script>
</body>
</html>
